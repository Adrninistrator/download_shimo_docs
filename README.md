# 1. 作用

石墨文档没有提供导入飞书文档的功能，飞书文档也没有提供从石墨文档导入的功能，以下提供从石墨文档批量迁移到飞书文档的方法

# 2. 总体步骤

总体步骤分为两步，首先需要从石墨文档下载文件，之后再将文件上传到飞书文档

# 3. 使用方式

## 3.1. 执行环境

在能够访问石墨文档及飞书文档的 Windows 环境中执行后续步骤，例如开发 VDI

## 3.2. 从石墨文档下载文件

### 3.2.1. 获取附件

打开 Github releases 页面 [https://github.com/Adrninistrator/download_shimo_docs/releases](https://github.com/Adrninistrator/download_shimo_docs/releases) 下载附件“download_shimo_docs.zip”到本地并解压

以上附件中包含了完整的 Python 运行环境、依赖库及 Python 脚本，不需要额外安装 Python 环境

### 3.2.2. 修改配置文件

使用文本编辑器打开配置文件 config.properties，并修改以下参数

或者双击执行“edit.bat”脚本，使用记事本打开以上配置文件

#### 3.2.2.1. sleep_time_seconds

当前参数用于指定每次请求石墨文档前等待的时间间隔，避免触发限制

单位为秒，支持指定浮点数，如“0.1”

若为 0 代表每次请求前不等待

#### 3.2.2.2. root_folder_guid

当前参数用于指定需要下载的石墨文档工作空间或目录的 guid

可通过以下方式获得：

使用浏览器打开石墨文档网站并登录： https://shimo.im/

打开需要下载的石墨文档工作空间或目录，复制 URL 中最后的一串字符串作为当前参数值

例如打开石墨文档的工作空间后，URL 为“https://shimo.im/space/aaaaaaaaaaaaaaaa”，则当前参数需要指定为“aaaaaaaaaaaaaaaa”

假如打开石墨文档的目录后，URL 为“https://shimo.im/folder/bbbbbbbbbbbbbbbb”，则当前参数需要指定为“bbbbbbbbbbbbbbbb”

#### 3.2.2.3. local_root_dir

当前参数用于指定需要下载的石墨文档文件保存到本地的根目录路径

#### 3.2.2.4. cookie

当前参数用于指定本地浏览器打开石墨文档网站后的 Cookies

可通过以下方式获得：

使用 Chrome 等浏览器打开石墨文档网站并登录

按 F12 打开 Chrome 开发者工具

切换到“Network”标签页

等待浏览器自动刷新，或者人工刷新浏览器

查看 Chrome 开发者工具“Network”标签页，点击任意请求，例如“files?folder=xxx”

下拉到“Request Headers”，三击“Cookie”后面的内容并复制

这样会得到很长一串字符串，内容全部作为当前参数值

#### 3.2.2.5. 完整示例

```
root_folder_guid = aaaaaaaaaaaaaaaa
local_root_dir = E:/my-desktop/temp/test_docs
cookie = xxx
```

### 3.2.3. 执行程序

双击“run.bat”脚本开始下载石墨文档文件到本地

### 3.2.4. 执行结果检查

在附件解压的目录，会生成“log”目录，其中保存了执行的日志文件

检查下载的石墨文档文件保存到本地的根目录，是否包含了对应的文件

石墨文档的“文档”、“传统文档”、“表格”、“幻灯片”，分别会保存为后缀为“.docx”、“.docx”、“.xlsx”、“.pptx”的文件

其他的文件类型，保持原有的文件类型

## 3.3. 将文件上传到飞书文档

### 3.3.1. 打开飞书云盘

在浏览器中打开飞书云盘

或者在飞书应用左侧通过“云文档”打开飞书云盘

### 3.3.2. 上传本地文件

进入需要上传本地文件的飞书云盘目录

将鼠标移到“上传”按钮上，点击“上传文件夹”按钮

选择本地需要上传的目录，点击“上传”按钮，等待上传

上传完毕后，当前所在的飞书云盘的目录中会创建一个与本地目录名称相同的目录，目录下包含本地的对应文件

# 4. 其他说明

## 4.1. 本地文件解密

从石墨文档下载文件后，不需要对目录或文件进行解密，可以直接上传到飞书文档

## 4.2. 飞书文档支持上传的文件类型

飞书文档支持上传的文件类型有变化，在 2025 年 8 月时，图片文件不支持上传，目前（2025 年 12 月 21 日）已支持
